# Project Context: Prism NGFW

This document summarizes the current state, architectural decisions, and immediate next steps for the Prism NGFW project.

## 1. Project Overview

- **Project Name**: Prism
- **Goal**: Build a containerized reverse-proxy NGFW/WAF in Go with a React dashboard for management.
- **Current Working Directory**: `/Users/kpradhan/Go-Projects/Prism`
- **Version Control**: Git repository initialized.

## 2. Architectural Decisions & Current State

### 2.1 Go Application Structure
- **Modular Design**: Code is organized into standard Go packages:
    - `cmd/prism`: Contains `main.go`, the application entry point.
    - `pkg/api`: Handles API endpoints.
    - `pkg/cache`: A thread-safe, in-memory caching component.
    - `pkg/firewall`: Contains firewall rules logic (`Middleware`).
    - `pkg/proxy`: Contains reverse proxy logic (`NewReverseProxy`, `Factory`).
    - `pkg/storage`: Handles database connection and data access.

### 2.2 Routing Strategy
- **Path-Based Routing**: The application uses a central `http.ServeMux` to route requests based on URL path.

### 2.3 Current Functionality (Working & Tested)
- **Core Backend**: A secure, multi-tenant reverse proxy and firewall.
- **Management API**: A full CRUD API for managing Projects and their associated firewall Rules.
- **Performance Optimization**: An in-memory cache for firewall rules is implemented to minimize database lookups on high-traffic routes. The cache is automatically invalidated when rules are changed via the API.

## 3. Immediate Next Step

The core backend API is feature-complete. The next phase can be chosen from the following major goals outlined in the project roadmap:

- **1. Begin React Dashboard (Phase 5):** Build the frontend UI to consume the completed management API.
- **2. Containerize the Application (Phase 6):** Create a `Dockerfile` and `docker-compose.yml` to make the project portable and easy to deploy.
- **3. Expand Firewall Features (Phase 4):** Implement more advanced DPI, such as inspecting response bodies for sensitive data.

## 4. Key Credentials (User's Responsibility)

- **Supabase Project URL**
- **Supabase `anon` key**
- **Supabase `service_role` key**
- **Supabase JWT Secret** (used for local verification, stored in `.env` as `SUPABASE_JWT_SECRET`)
- **Supabase Database Connection String** (Transaction Pooler, stored in `.env` as `DATABASE_URL`)
- **Supabase Database Password**
